<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer une Playlist Deezer</title>
</head>
<body>
    <h1>Créer une Playlist Deezer</h1>
    <form id="playlist-form">
        <label for="song-list">Collez votre liste de chansons (Titre - Artiste) :</label><br>
        <textarea id="song-list" rows="10" cols="50"></textarea><br><br>
        <button type="button" onclick="createPlaylist()">Créer la Playlist</button>
    </form>
    <p id="status"></p>

    <script>
        async function createPlaylist() {
            const songList = document.getElementById("song-list").value;
            const status = document.getElementById("status");

            // Séparer la liste de chansons
            const songs = songList.split('\n').map(line => {
                const parts = line.split('-');
                return {
                    title: parts[0]?.trim(),
                    artist: parts[1]?.trim()
                };
            });

            try {
                // Obtention du token d'accès Deezer (à remplacer par le vrai processus d'authentification)
                const accessToken = "TON_TOKEN_DACCES"; // Remplacez par votre token d'accès valide

                // Créer une playlist
                const playlistName = "Ma Nouvelle Playlist";
                const response = await fetch(`https://api.deezer.com/user/me/playlists?access_token=${accessToken}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title: playlistName })
                });
                const playlistData = await response.json();

                if (!playlistData.id) {
                    status.innerText = "Erreur lors de la création de la playlist.";
                    return;
                }

                const playlistId = playlistData.id;

                // Ajouter des chansons à la playlist
                for (let song of songs) {
                    const searchQuery = `${song.title} ${song.artist}`;
                    const searchResponse = await fetch(`https://api.deezer.com/search?q=${encodeURIComponent(searchQuery)}&access_token=${accessToken}`);
                    const searchData = await searchResponse.json();

                    if (searchData.data.length > 0) {
                        const trackId = searchData.data[0].id;
                        await fetch(`https://api.deezer.com/playlist/${playlistId}/tracks?access_token=${accessToken}&songs=${trackId}`, {
                            method: 'POST'
                        });
                    }
                }

                status.innerText = `Playlist '${playlistName}' créée avec succès !`;
            } catch (error) {
                console.error('Erreur :', error);
                status.innerText = "Une erreur est survenue lors de la création de la playlist.";
            }
        }
    </script>
</body>
</html>

